!function(a){"use strict";a.fn.carousel=function(b){var c,d;return c={infinite:!0,visible:1,speed:"fast",overflow:!1,autoRotate:!1,navigation:a(this).data("navigation"),itemMinWidth:0,itemEqualHeight:!1,itemMargin:0,itemClassActive:"crsl-active",imageWideClass:"wide-image",navDotClassActive:"crsl-dot-active",carousel:!0},a(this).each(function(){d=a(this),a.isEmptyObject(b)===!1&&a.extend(c,b),a.isEmptyObject(a(d).data("crsl"))===!1&&a.extend(c,a(d).data("crsl")),c.isTouch="ontouchstart"in document.documentElement||navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1,c.navigationWithDots=0!==a("#"+c.navigation).find(".crsl-dot").length?!0:!1,c.navigationWithDots&&(c.infinite=!1),d.init=function(){if(c.total=a(d).find(".crsl-item").length,c.itemWidth=a(d).outerWidth(),c.visibleDefault=c.visible,c.swipeDistance=null,c.swipeMinDistance=100,c.startCoords={},c.endCoords={},a(d).css({width:"100%"}),a(d).find(".crsl-item").css({position:"relative","float":"left",overflow:"hidden",height:"auto"}),a(d).find("."+c.imageWideClass).each(function(){a(this).css({display:"block",width:"100%",height:"auto"})}),a(d).find(".crsl-item iframe").attr({width:"100%"}),c.carousel&&a(d).find(".crsl-item:first-child").addClass(c.itemClassActive),c.navigationWithDots&&c.visible<c.total){a("#"+c.navigation).find(".crsl-dot:eq(0)").addClass(c.navDotClassActive);for(var b=[],e=[],f=0;f<c.visible;f++)b.push(a(".crsl-item:eq("+f+")",d).clone().attr("id","")),e.push(a(".crsl-item:eq("+(c.total-1+f)+")",d).clone().attr("id",""));a(d).find(".crsl-item:first-child").before(e),a(d).find(".crsl-item:last-child").after(b),c.total=c.total+2*c.visible,c.itemWidth=a(d).outerWidth()}else c.carousel&&c.infinite&&c.visible<c.total&&a(d).find(".crsl-item:first-child").before(a(".crsl-item:last-child",d));c.overflow===!1?a(d).css({overflow:"hidden"}):a("html, body").css({"overflow-x":"hidden"}),a(d).trigger("initCarousel",[c,d]),d.testPreload(),d.config(),d.initRotate(),d.triggerNavs()},d.testPreload=function(){if(a(d).find("img").length>0){var b=a(d).find("img").length,e=1;a(d).find("img").each(function(){d.preloadImage(this,e,b),e++})}else a(d).trigger("loadedCarousel",[c,d])},d.preloadImage=function(b,e,f){var g=new Image,h={};h.src=void 0!==a(b).attr("src")?b.src:"",h.alt=void 0!==a(b).attr("alt")?b.alt:"",a(g).attr(h),a(g).on("load",function(){1===e&&a(d).trigger("loadingImagesCarousel",[c,d]),e===f&&a(d).trigger("loadedImagesCarousel",[c,d])})},d.config=function(){c.itemWidth=Math.floor((a(d).outerWidth()-c.itemMargin*(c.visibleDefault-1))/c.visibleDefault),c.itemWidth<=c.itemMinWidth?(c.visible=1===Math.floor((a(d).outerWidth()-c.itemMargin*(c.visible-1))/c.itemMinWidth)?Math.floor(a(d).outerWidth()/c.itemMinWidth):Math.floor((a(d).outerWidth()-c.itemMargin)/c.itemMinWidth),c.visible=c.visible<1?1:c.visible,c.itemWidth=1===c.visible?Math.floor(a(d).outerWidth()):Math.floor((a(d).outerWidth()-c.itemMargin*(c.visible-1))/c.visible)):c.visible=c.visibleDefault,c.carousel?(d.wrapWidth=Math.floor((c.itemWidth+c.itemMargin)*c.total),d.wrapMargin=d.wrapMarginDefault=(c.infinite||c.navigationWithDots)&&c.visible<c.total?parseInt(-1*(c.itemWidth+c.itemMargin),10):0,c.infinite&&c.visible<c.total&&0===a(d).find(".crsl-item."+c.itemClassActive).index()&&(a(d).find(".crsl-item:first-child").before(a(".crsl-item:last-child",d)),d.wrapMargin=d.wrapMarginDefault=parseInt(-1*(c.itemWidth+c.itemMargin),10)),a(d).find(".crsl-wrap").css({width:d.wrapWidth+"px",marginLeft:d.wrapMargin})):(d.wrapWidth=a(d).outerWidth(),a(d).find(".crsl-wrap").css({width:d.wrapWidth+c.itemMargin+"px"}),a("#"+c.navigation).hide()),a(d).find(".crsl-item").css({width:c.itemWidth+"px",marginRight:c.itemMargin+"px"}),d.equalHeights(),c.carousel&&(c.visible>=c.total?(c.autoRotate=!1,a("#"+c.navigation).hide()):a("#"+c.navigation).show())},d.equalHeights=function(){if(c.itemEqualHeight!==!1){var b=0;a(d).find(".crsl-item").each(function(){a(this).css({height:"auto"}),a(this).outerHeight()>b&&(b=a(this).outerHeight())}),a(d).find(".crsl-item").css({height:b+"px"})}return!0},d.initRotate=function(){c.autoRotate!==!1&&(d.rotateTime=window.setInterval(function(){d.rotate()},c.autoRotate))},d.triggerNavs=function(){a("#"+c.navigation).delegate(".previous, .next","click",function(b){if(b.preventDefault(),d.prepareExecute(),a(this).hasClass("previous")&&d.testPrevious(d.itemActive))d.previous();else{if(!a(this).hasClass("next")||!d.testNext())return;d.next()}}),a("#"+c.navigation).delegate(".crsl-dot","click",function(b){b.preventDefault(),d.prepareExecute(),d.move(a(this))})},d.prepareExecute=function(){return c.autoRotate&&clearInterval(d.rotateTime),d.preventAnimateEvent()===!1?!1:(d.itemActive=a(d).find(".crsl-item."+c.itemClassActive),!0)},d.preventAnimateEvent=function(){return a(d).find(".crsl-wrap:animated").length>0?!1:void 0},d.rotate=function(){return d.preventAnimateEvent(),d.itemActive=a(d).find(".crsl-item."+c.itemClassActive),d.next(),!0},d.testPrevious=function(b){return a(".crsl-wrap",d).find(".crsl-item").index(b)>0},d.testNext=function(){return!c.infinite&&d.wrapWidth>=(c.itemWidth+c.itemMargin)*(c.visible+1)-d.wrapMargin||c.infinite},d.previous=function(){d.wrapMargin=c.infinite?d.wrapMarginDefault+a(d.itemActive).outerWidth(!0):d.wrapMargin+a(d.itemActive).outerWidth(!0);var b=(a(d.itemActive).index(),a(d.itemActive).prev(".crsl-item")),e="previous";a(d).trigger("beginCarousel",[c,d,e]),a(d).find(".crsl-wrap").animate({marginLeft:d.wrapMargin+"px"},c.speed,function(){a(d.itemActive).removeClass(c.itemClassActive),a(b).addClass(c.itemClassActive),c.infinite?a(this).css({marginLeft:d.wrapMarginDefault}).find(".crsl-item:first-child").before(a(".crsl-item:last-child",d)):(d.testPrevious(b)===!1&&a("#"+c.navigation).find(".previous").addClass("previous-inactive"),d.testNext()&&a("#"+c.navigation).find(".next").removeClass("next-inactive")),a(this).trigger("endCarousel",[c,d,e])})},d.next=function(){d.wrapMargin=c.infinite?d.wrapMarginDefault-a(d.itemActive).outerWidth(!0):d.wrapMargin-a(d.itemActive).outerWidth(!0);var b=(a(d.itemActive).index(),a(d.itemActive).next(".crsl-item")),e="next";a(d).trigger("beginCarousel",[c,d,e]),a(d).find(".crsl-wrap").animate({marginLeft:d.wrapMargin+"px"},c.speed,function(){a(d.itemActive).removeClass(c.itemClassActive),a(b).addClass(c.itemClassActive),c.infinite?a(this).css({marginLeft:d.wrapMarginDefault}).find(".crsl-item:last-child").after(a(".crsl-item:first-child",d)):(d.testPrevious(b)&&a("#"+c.navigation).find(".previous").removeClass("previous-inactive"),d.testNext()===!1&&a("#"+c.navigation).find(".next").addClass("next-inactive")),a(this).trigger("endCarousel",[c,d,e])})},d.move=function(b){var e=a(b[0].hash),f="move";d.wrapMargin=e.outerWidth(!0)*e.index()*-1,a(d).trigger("beginCarousel",[c,d,f]),a("#"+c.navigation).find(".crsl-dot."+c.navDotClassActive).removeClass(c.navDotClassActive),a(b).addClass(c.navDotClassActive),a(d).find(".crsl-wrap").animate({marginLeft:d.wrapMargin+"px"},c.speed,function(){a(d.itemActive).removeClass(c.itemClassActive),a(e).addClass(c.itemClassActive),a(this).trigger("endCarousel",[c,d,f])})};var e,f=!1;a(window).on("mouseleave",function(b){return b.target?e=b.target:b.srcElement&&(e=b.srcElement),f=a(d).attr("id")&&a(e).parents(".crsl-items").attr("id")===a(d).attr("id")||a(e).parents(".crsl-items").data("navigation")===a(d).data("navigation")?!0:!1,!1}),a(window).on("keydown",function(a){f===!0&&(37===a.keyCode?(d.prepareExecute(),d.previous()):39===a.keyCode&&(d.prepareExecute(),d.next()))}),c.isTouch&&a(d).on("touchstart",function(b){a(d).addClass("touching"),c.startCoords=b.originalEvent.targetTouches[0],c.endCoords=b.originalEvent.targetTouches[0],a(".touching").on("touchmove",function(a){c.endCoords=a.originalEvent.targetTouches[0],Math.abs(parseInt(c.endCoords.pageX-c.startCoords.pageX,10))>Math.abs(parseInt(c.endCoords.pageY-c.startCoords.pageY,10))&&(a.preventDefault(),a.stopPropagation())})}).on("touchend",function(b){b.preventDefault(),b.stopPropagation(),c.swipeDistance=c.endCoords.pageX-c.startCoords.pageX,c.swipeDistance>=c.swipeMinDistance?d.previous():c.swipeDistance<=-c.swipeMinDistance&&d.next(),a(".touching").off("touchmove").removeClass("touching")}),a(d).on("loadedCarousel loadedImagesCarousel",function(){d.equalHeights()}),a(window).on("carouselResizeEnd",function(){c.itemWidth!==a(d).outerWidth()&&d.config()}),a(window).ready(function(){a(d).trigger("prepareCarousel",[c,d]),d.init(),a(window).on("resize",function(){this.carouselResizeTo&&clearTimeout(this.carouselResizeTo),this.carouselResizeTo=setTimeout(function(){a(this).trigger("carouselResizeEnd")},10)})}),a(window).load(function(){d.testPreload(),d.config()})})}}(jQuery);